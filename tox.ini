[tox]
envlist = pytests, lint, format-check, typecheck, rust-fmt, rust-clippy
isolated_build = false
skip_missing_interpreters = true

[testenv:pytests]
allowlist_externals = uv
commands =
    uv run pytest --maxfail=1 --durations=5

[testenv:lint]
allowlist_externals = uv
commands =
    uv run ruff check .

[testenv:format-check]
allowlist_externals = uv
commands =
    uv run ruff format --check --diff

[testenv:typecheck]
allowlist_externals = uv
commands =
    uv run pyright .

[testenv:rust-fmt]
allowlist_externals = cargo
commands =
    cargo fmt --all -- --check

[testenv:rust-clippy]
allowlist_externals = cargo
commands =
    cargo clippy --all-targets -- -D warnings -A clippy::useless_conversion
